<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Art Drawer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation; /* Better touch interaction */
        }
        #pixel-grid {
            display: grid;
            border: 1px solid #d1d5db; /* Tailwind gray-300 */
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            touch-action: none; /* Prevent scrolling while drawing on grid on touch devices */
        }
        .pixel {
            width: 100%; /* Fill grid cell */
            height: 100%; /* Fill grid cell */
            background-color: #ffffff; /* Default white */
            border: 1px solid #e5e7eb; /* Tailwind gray-200 - light border for pixels */
            cursor: pointer;
            transition: background-color 0.1s ease;
        }
        .color-swatch {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.1s ease, box-shadow 0.2s ease;
            border: 2px solid transparent;
        }
        .color-swatch.selected {
            transform: scale(1.15);
            box-shadow: 0 0 0 3px #6366f1; /* Tailwind indigo-500 as ring */
            border-color: white;
        }
        .control-button {
            padding: 0.6rem 1.2rem;
            font-size: 0.9rem;
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.2s ease, opacity 0.2s ease;
        }
         .input-field {
            padding: 0.5rem;
            border: 1px solid #cbd5e0; /* Tailwind gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
            width: 70px; /* Fixed width for size input */
            text-align: center;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-start min-h-screen p-4 sm:p-6">

    <div class="bg-white p-5 sm:p-8 rounded-xl shadow-2xl w-full max-w-2xl">
        <h1 class="text-3xl sm:text-4xl font-bold text-center text-purple-600 mb-6">Pixel Art Drawer</h1>

        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
            <div id="color-palette" class="flex flex-wrap justify-center gap-2 p-2 bg-gray-100 rounded-lg">
                {/* Color swatches will be generated by JS */}
            </div>
            <div class="flex items-center gap-2">
                <label for="grid-size-input" class="text-sm font-medium text-gray-700">Grid Size:</label>
                <input type="number" id="grid-size-input" value="16" min="4" max="64" step="4" class="input-field">
                <button id="set-size-button" class="control-button bg-blue-500 hover:bg-blue-600 text-white font-semibold">Set</button>
            </div>
        </div>
        
        <div id="pixel-grid-container" class="flex justify-center mb-6">
             <div id="pixel-grid" class="w-full max-w-[500px] aspect-square"> {/* Constrain grid size and maintain aspect ratio */}
                {/* Pixels will be generated by JS */}
            </div>
        </div>


        <div class="flex justify-center space-x-4">
            <button id="clear-button" class="control-button bg-red-500 hover:bg-red-600 text-white font-semibold">Clear Grid</button>
            <button id="eraser-button" class="control-button bg-gray-500 hover:bg-gray-600 text-white font-semibold">Eraser</button>
        </div>
    </div>

    <script>
        const pixelGrid = document.getElementById('pixel-grid');
        const colorPaletteContainer = document.getElementById('color-palette');
        const clearButton = document.getElementById('clear-button');
        const eraserButton = document.getElementById('eraser-button');
        const gridSizeInput = document.getElementById('grid-size-input');
        const setSizeButton = document.getElementById('set-size-button');

        const defaultPixelColor = '#ffffff'; // White
        const eraserColor = defaultPixelColor;
        let selectedColor = '#000000'; // Default to black
        let currentGridSize = 16;
        let isErasing = false;
        let isMouseDown = false; // For click-and-drag drawing

        const colors = [
            '#000000', '#ffffff', '#ff0000', '#00ff00', '#0000ff', '#ffff00', 
            '#ff00ff', '#00ffff', '#ffa500', '#800080', '#a52a2a', '#808080',
            '#f06292', '#4db6ac', '#fff176', '#9575cd' // Pink, Teal, Pale Yellow, Lavender
        ];

        function createColorPalette() {
            colorPaletteContainer.innerHTML = ''; // Clear existing
            colors.forEach(color => {
                const swatch = document.createElement('div');
                swatch.classList.add('color-swatch');
                swatch.style.backgroundColor = color;
                swatch.dataset.color = color;
                if (color === selectedColor && !isErasing) {
                    swatch.classList.add('selected');
                }
                swatch.addEventListener('click', () => {
                    selectColor(color, swatch);
                    isErasing = false;
                    updateEraserButtonState();
                });
                colorPaletteContainer.appendChild(swatch);
            });
        }

        function selectColor(color, swatchElement) {
            selectedColor = color;
            // Update selected state for swatches
            document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('selected'));
            if (swatchElement && !isErasing) {
                 swatchElement.classList.add('selected');
            } else if (!isErasing) { // If color selected programmatically (e.g. after eraser)
                const newSelectedSwatch = Array.from(document.querySelectorAll('.color-swatch')).find(s => s.dataset.color === color);
                if (newSelectedSwatch) newSelectedSwatch.classList.add('selected');
            }
        }
        
        function updateEraserButtonState() {
            if (isErasing) {
                eraserButton.classList.add('bg-blue-500', 'hover:bg-blue-600');
                eraserButton.classList.remove('bg-gray-500', 'hover:bg-gray-600');
                document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('selected'));
            } else {
                eraserButton.classList.remove('bg-blue-500', 'hover:bg-blue-600');
                eraserButton.classList.add('bg-gray-500', 'hover:bg-gray-600');
                // Re-select the current color if not erasing
                const currentSelectedSwatch = Array.from(document.querySelectorAll('.color-swatch')).find(s => s.dataset.color === selectedColor);
                if (currentSelectedSwatch) currentSelectedSwatch.classList.add('selected');
            }
        }


        function createPixelGrid(size) {
            pixelGrid.innerHTML = ''; // Clear previous grid
            pixelGrid.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            pixelGrid.style.gridTemplateRows = `repeat(${size}, 1fr)`;

            for (let i = 0; i < size * size; i++) {
                const pixel = document.createElement('div');
                pixel.classList.add('pixel');
                
                // Mouse down to start drawing (or drag-drawing)
                pixel.addEventListener('mousedown', (e) => {
                    e.preventDefault(); // Prevent text selection/drag behavior
                    isMouseDown = true;
                    colorPixel(pixel);
                });
                // Mouse enter while mouse is down (drag-drawing)
                pixel.addEventListener('mouseenter', () => {
                    if (isMouseDown) {
                        colorPixel(pixel);
                    }
                });
                // Touch events for mobile drawing
                pixel.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    isMouseDown = true; // Use same flag for touch
                    colorPixel(pixel);
                });
                pixel.addEventListener('touchmove', (e) => {
                    e.preventDefault();
                    if (isMouseDown) {
                        // Get the element under the touch point
                        const touch = e.touches[0];
                        const targetElement = document.elementFromPoint(touch.clientX, touch.clientY);
                        if (targetElement && targetElement.classList.contains('pixel')) {
                            colorPixel(targetElement);
                        }
                    }
                });

                pixelGrid.appendChild(pixel);
            }
        }
        
        // Global listeners for mouseup/touchend to stop drawing
        document.addEventListener('mouseup', () => {
            isMouseDown = false;
        });
        document.addEventListener('touchend', () => {
            isMouseDown = false;
        });


        function colorPixel(pixelElement) {
            if (isErasing) {
                pixelElement.style.backgroundColor = eraserColor;
            } else {
                pixelElement.style.backgroundColor = selectedColor;
            }
        }

        clearButton.addEventListener('click', () => {
            document.querySelectorAll('.pixel').forEach(pixel => {
                pixel.style.backgroundColor = defaultPixelColor;
            });
        });

        eraserButton.addEventListener('click', () => {
            isErasing = !isErasing;
            updateEraserButtonState();
        });
        
        setSizeButton.addEventListener('click', () => {
            const newSize = parseInt(gridSizeInput.value);
            if (newSize >= 4 && newSize <= 64) {
                currentGridSize = newSize;
                createPixelGrid(currentGridSize);
            } else {
                // Simple alert for now, could be a custom modal
                alert("Please enter a grid size between 4 and 64.");
                gridSizeInput.value = currentGridSize; // Reset to valid
            }
        });


        // Initial setup
        window.addEventListener('DOMContentLoaded', () => {
            createColorPalette();
            createPixelGrid(currentGridSize);
            gridSizeInput.value = currentGridSize;
            updateEraserButtonState(); // Set initial eraser button style
        });

    </script>
</body>
</html>
